import{S as gt,a as Ct,A as yt}from"./sweetalert2.esm.all-DSd_L38J.js";import{l as J,m as At,p as Z,q as It,s as wt,u as Nt,d as St,r as k,v as xt,c as q,x as Lt,o as Ot,w as Dt,a as I,b as w,e,f as x,y as Rt,_ as kt,j as W,i as Vt,z as Pt,F as V,g as z,t as v,h as $t,k as P,A as Mt}from"./main-qbu05jWT.js";import{a as Xt,c as Ut}from"./products-Bl5fZNFl.js";var $={exports:{}},M={exports:{}};/*!
  * Bootstrap swipe.js v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var qt=M.exports,Q;function Wt(){return Q||(Q=1,(function(L,b){(function(d,c){L.exports=c(J(),At(),Z())})(qt,(function(d,c,T){const a="swipe",l=".bs.swipe",C=`touchstart${l}`,N=`touchmove${l}`,O=`touchend${l}`,u=`pointerdown${l}`,m=`pointerup${l}`,S="touch",_="pen",n="pointer-event",h=40,o={endCallback:null,leftCallback:null,rightCallback:null},f={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class E extends c{constructor(s,y){super(),this._element=s,!(!s||!E.isSupported())&&(this._config=this._getConfig(y),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return o}static get DefaultType(){return f}static get NAME(){return a}dispose(){d.off(this._element,l)}_start(s){if(!this._supportPointerEvents){this._deltaX=s.touches[0].clientX;return}this._eventIsPointerPenTouch(s)&&(this._deltaX=s.clientX)}_end(s){this._eventIsPointerPenTouch(s)&&(this._deltaX=s.clientX-this._deltaX),this._handleSwipe(),T.execute(this._config.endCallback)}_move(s){this._deltaX=s.touches&&s.touches.length>1?0:s.touches[0].clientX-this._deltaX}_handleSwipe(){const s=Math.abs(this._deltaX);if(s<=h)return;const y=s/this._deltaX;this._deltaX=0,y&&T.execute(y>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(d.on(this._element,u,s=>this._start(s)),d.on(this._element,m,s=>this._end(s)),this._element.classList.add(n)):(d.on(this._element,C,s=>this._start(s)),d.on(this._element,N,s=>this._move(s)),d.on(this._element,O,s=>this._end(s)))}_eventIsPointerPenTouch(s){return this._supportPointerEvents&&(s.pointerType===_||s.pointerType===S)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}return E}))})(M)),M.exports}/*!
  * Bootstrap carousel.js v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var Bt=$.exports,H;function Yt(){return H||(H=1,(function(L,b){(function(d,c){L.exports=c(It(),J(),wt(),Nt(),Z(),Wt())})(Bt,(function(d,c,T,a,l,C){const N="carousel",u=".bs.carousel",m=".data-api",S="ArrowLeft",_="ArrowRight",n=500,h="next",o="prev",f="left",E="right",j=`slide${u}`,s=`slid${u}`,y=`keydown${u}`,tt=`mouseenter${u}`,et=`mouseleave${u}`,st=`dragstart${u}`,it=`load${u}${m}`,nt=`click${u}${m}`,B="carousel",D="active",ot="slide",at="carousel-item-end",rt="carousel-item-start",lt="carousel-item-next",ct="carousel-item-prev",Y=".active",K=".carousel-item",ut=Y+K,dt=".carousel-item img",_t=".carousel-indicators",ht="[data-bs-slide], [data-bs-slide-to]",pt='[data-bs-ride="carousel"]',mt={[S]:E,[_]:f},ft={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Et={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class A extends d{constructor(t,i){super(t,i),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=a.findOne(_t,this._element),this._addEventListeners(),this._config.ride===B&&this.cycle()}static get Default(){return ft}static get DefaultType(){return Et}static get NAME(){return N}next(){this._slide(h)}nextWhenVisible(){!document.hidden&&l.isVisible(this._element)&&this.next()}prev(){this._slide(o)}pause(){this._isSliding&&l.triggerTransitionEnd(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){c.one(this._element,s,()=>this.cycle());return}this.cycle()}}to(t){const i=this._getItems();if(t>i.length-1||t<0)return;if(this._isSliding){c.one(this._element,s,()=>this.to(t));return}const r=this._getItemIndex(this._getActive());if(r===t)return;const g=t>r?h:o;this._slide(g,i[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&c.on(this._element,y,t=>this._keydown(t)),this._config.pause==="hover"&&(c.on(this._element,tt,()=>this.pause()),c.on(this._element,et,()=>this._maybeEnableCycle())),this._config.touch&&C.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const r of a.find(dt,this._element))c.on(r,st,g=>g.preventDefault());const i={leftCallback:()=>this._slide(this._directionToOrder(f)),rightCallback:()=>this._slide(this._directionToOrder(E)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),n+this._config.interval))}};this._swipeHelper=new C(this._element,i)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const i=mt[t.key];i&&(t.preventDefault(),this._slide(this._directionToOrder(i)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const i=a.findOne(Y,this._indicatorsElement);i.classList.remove(D),i.removeAttribute("aria-current");const r=a.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);r&&(r.classList.add(D),r.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const i=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=i||this._config.defaultInterval}_slide(t,i=null){if(this._isSliding)return;const r=this._getActive(),g=t===h,p=i||l.getNextActiveElement(this._getItems(),r,g,this._config.wrap);if(p===r)return;const F=this._getItemIndex(p),G=Tt=>c.trigger(this._element,Tt,{relatedTarget:p,direction:this._orderToDirection(t),from:this._getItemIndex(r),to:F});if(G(j).defaultPrevented||!r||!p)return;const vt=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(F),this._activeElement=p;const R=g?rt:at,U=g?lt:ct;p.classList.add(U),l.reflow(p),r.classList.add(R),p.classList.add(R);const bt=()=>{p.classList.remove(R,U),p.classList.add(D),r.classList.remove(D,U,R),this._isSliding=!1,G(s)};this._queueCallback(bt,r,this._isAnimated()),vt&&this.cycle()}_isAnimated(){return this._element.classList.contains(ot)}_getActive(){return a.findOne(ut,this._element)}_getItems(){return a.find(K,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return l.isRTL()?t===f?o:h:t===f?h:o}_orderToDirection(t){return l.isRTL()?t===o?f:E:t===o?E:f}static jQueryInterface(t){return this.each(function(){const i=A.getOrCreateInstance(this,t);if(typeof t=="number"){i.to(t);return}if(typeof t=="string"){if(i[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);i[t]()}})}}return c.on(document,nt,ht,function(X){const t=a.getElementFromSelector(this);if(!t||!t.classList.contains(B))return;X.preventDefault();const i=A.getOrCreateInstance(t),r=this.getAttribute("data-bs-slide-to");if(r){i.to(r),i._maybeEnableCycle();return}if(T.getDataAttribute(this,"slide")==="next"){i.next(),i._maybeEnableCycle();return}i.prev(),i._maybeEnableCycle()}),c.on(window,it,()=>{const X=a.find(pt);for(const t of X)A.getOrCreateInstance(t)}),l.defineJQueryPlugin(A),A}))})($)),$.exports}Yt();const Kt={class:"container"},Ft={class:"row align-items-center"},Gt={class:"col-md-7"},zt={"aria-label":"breadcrumb"},Qt={class:"breadcrumb bg-white px-0 mb-0 py-3"},Ht={class:"breadcrumb-item"},Jt={class:"breadcrumb-item"},Zt={id:"carouselExample",class:"carousel slide"},jt={class:"carousel-container carousel-inner"},te={class:"carousel-item active"},ee=["src"],se=["src"],ie={class:"col-md-5"},ne={class:"fw-bold h1 mb-1"},oe={class:"mb-0 text-muted text-end"},ae={class:"h4 fw-bold text-end"},re={class:"row align-items-center"},le={class:"col-6"},ce={class:"input-group my-3 bg-light rounded"},ue={class:"input-group-prepend"},de=["disabled"],_e=["value"],he={class:"input-group-append"},pe={class:"row my-5"},me={class:"col-md-4"},fe={class:"col-md-3"},Ee={style:{"white-space":"pre-wrap"},class:"text-muted"},ve={class:"swiper-wrapper"},be={class:"card border-0 mb-4 position-relative position-relative"},Te=["src","alt"],ge={class:"card-body p-0"},Ce={class:"mb-0 mt-3"},ye={class:"card-text mb-0"},Ae={class:"text-muted"},xe=St({__name:"ProductDetailView",setup(L){const b=k(1),d=Lt(),c=xt(),T=q(()=>d.params.id),a=k({category:"",content:"",description:"",id:"",imageUrl:"",imagesUrl:[],is_enabled:0,num:0,origin_price:0,price:0,title:"",unit:""}),l=k([]),C=async()=>{try{const _=await Ut(T.value);a.value=_.data.product}catch{alert("取得產品資訊失敗")}};Ot(()=>{C(),O()});const N=q(()=>a.value?a.value.category:""),O=async()=>{try{const _=await Xt({category:N.value});l.value=_.data.products}catch{alert("取得產品列表失敗")}},u=q(()=>l.value?l.value.filter(_=>_.id!==d.params.id):[]),m=k(null);Dt(()=>u.value,async _=>{_.length!==0&&(await Mt(),m.value&&new Ct(m.value,{modules:[yt],loop:!0,autoplay:{delay:2500,disableOnInteraction:!1},slidesPerView:2,spaceBetween:10,breakpoints:{767:{slidesPerView:3,spaceBetween:30}}}))});const S=async()=>{try{await c.addCartItem({product_id:T.value,qty:b.value}),gt.fire({toast:!0,position:"top-end",icon:"success",title:"已加入購物車",showConfirmButton:!1,timer:1500})}catch{alert("加入購物車失敗")}};return(_,n)=>{const h=Vt("RouterLink");return w(),I(V,null,[e("div",Kt,[x(kt),e("div",Ft,[e("div",Gt,[e("nav",zt,[e("ol",Qt,[e("li",Ht,[x(h,{class:"text-muted",to:"/"},{default:W(()=>[...n[2]||(n[2]=[P("首頁",-1)])]),_:1})]),e("li",Jt,[x(h,{class:"text-muted",to:"/products"},{default:W(()=>[...n[3]||(n[3]=[P("產品列表",-1)])]),_:1})]),n[4]||(n[4]=e("li",{class:"breadcrumb-item active","aria-current":"page"},"產品詳細",-1))])]),e("div",Zt,[e("div",jt,[e("div",te,[e("img",{src:a.value?.imageUrl,class:"d-block w-100",alt:"主圖"},null,8,ee)]),(w(!0),I(V,null,z(a.value?.imagesUrl?.filter(o=>o!==a.value?.imageUrl),o=>(w(),I("div",{key:o,class:"carousel-item"},[e("img",{src:o,class:"d-block w-100",alt:"副圖"},null,8,se)]))),128))]),n[5]||(n[5]=Pt('<button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="visually-hidden">Previous</span></button><button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="visually-hidden">Next</span></button>',2))])]),e("div",ie,[e("h2",ne,v(a.value?.title),1),e("p",oe,[e("del",null,"NT$"+v(a.value?.origin_price?.toLocaleString("zh-TW")),1)]),e("p",ae,"NT$"+v(a.value?.price?.toLocaleString("zh-TW")),1),e("div",re,[e("div",le,[e("div",ce,[e("div",ue,[e("button",{onClick:n[0]||(n[0]=o=>b.value--),disabled:b.value<=1,class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1"},[...n[6]||(n[6]=[e("i",{class:"fas fa-minus"},null,-1)])],8,de)]),e("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none bg-light",readonly:"",value:b.value},null,8,_e),e("div",he,[e("button",{onClick:n[1]||(n[1]=o=>b.value++),class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2"},[...n[7]||(n[7]=[e("i",{class:"fas fa-plus"},null,-1)])])])])]),e("div",{class:"col-6"},[e("button",{onClick:S,type:"button",class:"text-nowrap btn btn-dark w-100 py-2"}," 加入購物車 ")])])])]),e("div",pe,[e("div",me,[e("p",null,v(a.value?.description),1)]),e("div",fe,[e("p",Ee,v(a.value?.content),1)])]),u.value.length?(w(),I(V,{key:0},[n[9]||(n[9]=e("h3",{class:"fw-bold"},"你可能會喜歡的植栽",-1)),e("div",{ref_key:"swiperContainer",ref:m,class:"swiper mt-4 mb-5"},[e("div",ve,[(w(!0),I(V,null,z(u.value,o=>(w(),I("div",{key:o.id,class:"swiper-slide"},[e("div",be,[e("img",{src:o.imageUrl,class:"card-img-top object-fit-cover rounded-0",style:{height:"280px"},alt:o.title},null,8,Te),e("div",ge,[e("h4",Ce,[x(h,{to:`/products/${o.id}`},{default:W(()=>[P(v(o.title),1)]),_:2},1032,["to"])]),e("p",ye,[P(" NT$"+v(o.price.toLocaleString("zh-TW"))+" ",1),e("span",Ae,[e("del",null,"NT$"+v(o.origin_price.toLocaleString("zh-TW")),1)])]),n[8]||(n[8]=e("p",{class:"text-muted mt-3"},null,-1))])])]))),128))])],512)],64)):Rt("",!0)]),x($t)],64)}}});export{xe as default};
